{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '33291155-7539ac0bf1c0d1be65bb6c22f';\n\nasync function getPictures({ searchQuery, currentPage, perPage }) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: perPage,\n  });\n\n  const { data } = await axios(`${BASE_URL}?${params}`);\n\n  return data;\n}\n\nexport { getPictures };\n","function createGalleryCard(hits) {\n  return hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<div class=\"photo-card\">\n     <a class=\"photo-card__link\" href=\"${largeImageURL}\"> <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" /></a>\n      <div class=\"info\">\n        <p class=\"info-item\">\n          <b>Likes</b>${likes}\n        </p>\n        <p class=\"info-item\">\n          <b>Views</b>${views}\n        </p>\n        <p class=\"info-item\">\n          <b>Comments</b>${comments}\n        </p>\n        <p class=\"info-item\">\n          <b>Downloads</b>${downloads}\n        </p>\n      </div>\n    </div>`;\n      }\n    )\n    .join('');\n}\nexport default function appendCards(hits, container) {\n  container.insertAdjacentHTML('beforeend', createGalleryCard(hits));\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { getPictures } from './js/pixabay-api.js';\nimport appendCards from './js/render-functions.js';\n\nconst refs = {\n  searchForm: document.getElementById('search-form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader-container'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\nconst hiddenClass = 'hidden';\n\nconst lightbox = new SimpleLightbox('.photo-card a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst queryParams = {\n  currentPage: 1,\n  searchQuery: '',\n  maxPage: 1,\n  perPage: 15,\n};\n\nrefs.searchForm.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  const form = event.currentTarget;\n  queryParams.searchQuery = form.elements.searchQuery.value.trim();\n\n  if (!queryParams.searchQuery) {\n    iziToast.error({\n      position: 'topRight',\n      message: 'Empty query!',\n    });\n    return;\n  }\n\n  refs.loader.classList.remove(hiddenClass);\n\n  queryParams.currentPage = 1;\n\n  try {\n    const { hits, totalHits } = await getPictures(queryParams);\n\n    if (totalHits === 0) {\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    }\n\n    queryParams.maxPage = Math.ceil(totalHits / queryParams.perPage);\n\n    refs.gallery.innerHTML = '';\n\n    appendCards(hits, refs.gallery);\n\n    lightbox.refresh();\n\n    if (totalHits > queryParams.perPage) {\n      refs.loadMoreBtn.classList.remove(hiddenClass);\n      refs.loadMoreBtn.addEventListener('click', handleLoadMore);\n    }\n  } catch (err) {\n    iziToast.error({\n      position: 'topRight',\n      message: err.message,\n    });\n  } finally {\n    form.reset();\n    refs.loader.classList.add(hiddenClass);\n  }\n}\n\nasync function handleLoadMore() {\n  queryParams.currentPage += 1;\n  refs.loader.classList.remove(hiddenClass);\n  refs.loadMoreBtn.classList.add(hiddenClass);\n\n  try {\n    const { hits } = await getPictures(queryParams);\n\n    appendCards(hits, refs.gallery);\n\n    lightbox.refresh();\n    scrollToNextImages();\n  } catch (err) {\n    iziToast.error({\n      position: 'topRight',\n      message: err.message,\n    });\n  } finally {\n    refs.loader.classList.add(hiddenClass);\n\n    if (queryParams.currentPage + 1 <= queryParams.maxPage) {\n      refs.loadMoreBtn.classList.remove(hiddenClass);\n    } else {\n      refs.loadMoreBtn.classList.add(hiddenClass);\n      iziToast.error({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      refs.loadMoreBtn.removeEventListener('click', handleLoadMore);\n    }\n  }\n}\n\nfunction scrollToNextImages() {\n  const card = document.querySelector('.photo-card');\n\n  if (!card) return;\n\n  const cardHeight = card.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["BASE_URL","API_KEY","getPictures","searchQuery","currentPage","perPage","params","data","axios","createGalleryCard","hits","webformatURL","largeImageURL","tags","likes","views","comments","downloads","appendCards","container","refs","hiddenClass","lightbox","SimpleLightbox","queryParams","handleSearch","event","form","iziToast","totalHits","handleLoadMore","err","scrollToNextImages","card","cardHeight"],"mappings":"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"}